
=head1 NAME

Gitty - web application for git (gitosis).

=head1 OVERVIEW

Gitty is a small web app, based on joke code base. It uses Mojolicious Perl framework.
Now it can makes and use Users, tunes gitosis config, adds public keys.

=head1 INSTALL

=head2 Clone it from repository

    git clone git@github.com:h15/gitty.git

=head2 Install Perl modules

    curl -L cpanmin.us | perl - Mojolicious Rose::DB Rose::DB::Object

=head2 Install initial params.

    ./script/gitty install host=localhost driver=mysql database=gitty \
    username=gitty password=secret

=head2 Create data base and tables.

Users' accounts need some data for save.

=head3 For MySQL


    CREATE TABLE `gitty`.`users` (
        `id` INT( 11 ) UNSIGNED NOT NULL AUTO_INCREMENT ,
        `groups` TINYTEXT NOT NULL ,
        `name` VARCHAR( 32 ) CHARACTER SET utf8 COLLATE utf8_bin NULL ,
        `mail` VARCHAR( 64 ) CHARACTER SET ascii COLLATE ascii_bin NOT NULL ,
        `regdate` INT( 11 ) UNSIGNED NOT NULL ,
        `password` VARCHAR( 32 ) CHARACTER SET ascii COLLATE ascii_bin NOT NULL DEFAULT '0',
        `ban_reason` INT( 2 ) UNSIGNED NOT NULL DEFAULT '0',
        `ban_time` INT( 11 ) UNSIGNED NOT NULL DEFAULT '0',
        `confirm_key` VARCHAR( 32 ) CHARACTER SET ascii COLLATE ascii_bin NOT NULL ,
        `confirm_time` INT( 11 ) UNSIGNED NOT NULL ,
        PRIMARY KEY ( `id` ) ,
        INDEX ( `id` ) ,
        UNIQUE (
            `name` ,
            `mail`
        )
    ) ENGINE = MYISAM ;

    INSERT INTO `gitty__users` (`id`, `groups`, `name`, `mail`, `regdate`, `password`, `ban_reason`, `ban_time`, `confirm_key`, `confirm_time`) VALUES(1, '', 'anonymous', 'anonymous@lorcode.org', 0, '0', 0, 0, '', 0);


    CREATE TABLE `gitty`.`articles` (
        `id` INT( 11 ) UNSIGNED NOT NULL AUTO_INCREMENT ,
        `title` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL ,
        `revision_id` INT( 11 ) UNSIGNED NOT NULL ,
        `status` INT( 2 ) UNSIGNED NOT NULL ,
        PRIMARY KEY ( `id` ) ,
        FOREIGN KEY ( `revision_id` ) REFERENCES revisions ( `id` ),
        INDEX ( `id` ) ,
        UNIQUE (
            `title`
        )
    ) ENGINE = MYISAM;


    CREATE TABLE `gitty`.`revisions` (
        `id` INT( 11 ) UNSIGNED NOT NULL AUTO_INCREMENT ,
        `article_id` INT( 11 ) UNSIGNED NOT NULL ,
        `text` TEXT CHARACTER SET utf8 COLLATE utf8_bin NOT NULL ,
        `datetime` INT( 11 ) UNSIGNED NOT NULL ,
        `user` INT( 11 ) UNSIGNED NOT NULL ,
        PRIMARY KEY ( `id` ) ,
        FOREIGN KEY ( `article_id` ) REFERENCES articles ( `id` ),
        INDEX ( `id` )
    ) ENGINE = MYISAM ;


=head1 Run

    ./script/gitty daemon

=head1 Errors

=over

=item Problem with config.dat

    Magic number checking on storable string failed at ../../lib/Storable.pm (autosplit into ../../lib/auto/Storable/thaw.al) line 415, at script/../lib/Mojolicious/Plugin/Config.pm line 20

If you see this message, file config.dat was broken. You can fix it by command
    
    ./script/joke install host=localhost driver=mysql database=gitty \
    username=gitty password=secret

But all configs will be lost.

=item Problem with gitosis config file

    [-] Need file name!
    [-] Can't read config file!
    [-] Can't write to config file!

This messages talks you, that Gitty cann't use correctly gitosis' configuration file.
What Gitty needs:

=over

=item Define path to file

Did you defined correct path to gitosis config file in C<./lib/Gitty.pm>?

=item Exists

Does file exists by path defined in Gitty config?

=item Readable

Gitosis config should be readable for Gitty.

=item Writable

Gitosis config should be writable for Gitty if you want use Gitty for configuration gitosis.

=back

=back

=head1 COPYRIGHT AND LICENSE

Copyright (C) 2011, Georgy Bazhukov.

This program is free software, you can redistribute it and/or modify it under
the terms of the Artistic License version 2.0.

=cut

